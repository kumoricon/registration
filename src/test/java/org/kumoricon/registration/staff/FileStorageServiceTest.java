package org.kumoricon.registration.staff;


import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.test.util.ReflectionTestUtils;

import java.awt.image.BufferedImage;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class FileStorageServiceTest {

    private FileStorageService fileStorageService;

    @BeforeEach
    public void setup() {
        fileStorageService = new FileStorageService();
        ReflectionTestUtils.setField(fileStorageService, "uploadPathString", UPLOAD_PATH_STRING);
        fileStorageService.createDirectories();
    }

    @Test
    public void storeFile() throws IOException {
        String happyCase = "John Smith";
        String forwardSlash = "/Test/Slash/File/Name";
        String backSlash = "\\Test\\Back\\Slash\\";
        String backticks = "````";
        String spaces = "Test name with spaces";
        String quotes = "\"Name\" \"in\" \"quotes\"";
        String colons = "Name:With:Colons";

        final List<String> badFileNames =
                Arrays.asList(happyCase, forwardSlash, backSlash, backticks, spaces, quotes, colons);

        for (String name : badFileNames) {
            fileStorageService.storeFile(name, EXAMPLE_IMAGE);
        }
    }

    @Test
    public void decodeImage() {
        BufferedImage result = fileStorageService.decodeImageFromString(EXAMPLE_IMAGE);
        assertEquals(200, result.getHeight());
        assertEquals(500, result.getWidth());
    }

    // Data captured from sigpad
    private static final String EXAMPLE_IMAGE = "data:image/png;base64,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";
    private static final String UPLOAD_PATH_STRING = "/tmp/registration/staffUpload";
}